{"version":"0.2.0","body":"/**\n * Excel table data can be represented as an array of objects in the form of JSON.\n * Each object represents a row in the table. This helps extract the data from Excel in a consistent format that is visible to the user. The data can then be given to other systems through Power Automate flows.\n */\n\nfunction main(workbook: ExcelScript.Workbook): TableData[] {\n  // Get the first table in the \"PlainTable\" worksheet.\n  // If you know the table name, use `workbook.getTable('TableName')` instead.\n  const table = workbook.getWorksheet(\"Sheet1\").getTables()[0];\n\n  // Get all the values from the table as text.\n  const texts = table.getRange().getTexts();\n\n  // Create an array of JSON objects that match the row structure.\n  let returnObjects: TableData[] = [];\n  if (table.getRowCount() > 0) {\n    returnObjects = returnObjectFromValues(texts);\n  }\n\n  // Log the information and return it for a Power Automate flow.\n  console.log(JSON.stringify(returnObjects));\n  return returnObjects;\n}\n\n// This function converts a 2D array of values into a generic JSON object.\n// In this case, we have defined the TableData object, but any similar interface would work.\nfunction returnObjectFromValues(values: string[][]): TableData[] {\n  let objectArray: TableData[] = [];\n  let objectKeys: string[] = [];\n  for (let i = 0; i < values.length; i++) {\n    if (i === 0) {\n      objectKeys = values[i];\n      continue;\n    }\n\n    let object = {};\n    for (let j = 0; j < values[i].length; j++) {\n      object[objectKeys[j]] = values[i][j];\n    }\n\n    objectArray.push(object as TableData);\n  }\n\n  return objectArray;\n}\n\ninterface TableData {\n  \"Event ID\": string;\n  Date: string;\n  Location: string;\n  Capacity: string;\n  Speakers: string;\n}\n","description":"Excel table data can be represented as an array of objects in the form of JSON. Each object represents a row in the table. This helps extract the data from Excel in a consistent format that is visible to the user. The data can then be given to other systems through Power Automate flows.","parameterInfo":"{\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{\"result\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"Event ID\":{\"type\":\"string\"},\"Date\":{\"type\":\"string\"},\"Location\":{\"type\":\"string\"},\"Capacity\":{\"type\":\"string\"},\"Speakers\":{\"type\":\"string\"}}}}}}}","apiInfo":"{\"variant\":\"synchronous\"}"}